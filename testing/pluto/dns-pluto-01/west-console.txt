west:~#
 TESTNAME=dns-pluto-01
west:~#
 source /testing/pluto/bin/westlocal.sh
west:~#
 : all occurs without DNS
west:~#
 ipsec setup stop
ipsec_setup: Stopping Openswan IPsec...
ipsec_setup: stop ordered, but IPsec does not appear to be running!
ipsec_setup: doing cleanup anyway...
west:~#
 ipsec setup start
ipsec_setup: Starting Openswan IPsec VERSION
west:~#
 /testing/pluto/bin/wait-until-pluto-started
west:~#
 ipsec auto --add dns--westnet-eastnet
000 failed to convert 'west.uml.freeswan.org.' at load time: does not look numeric and name lookup failed
000 failed to convert 'east.uml.freeswan.org.' at load time: does not look numeric and name lookup failed
west:~#
 ipsec whack --debug-dns 
west:~#
 ipsec whack --status
000 interface ipsec0/eth1 192.1.2.45
000 %myid = (none)
000 debug dns
000  
000 algorithm ESP encrypt: id=3, name=ESP_3DES, ivlen=64, keysizemin=192, keysizemax=192
000 algorithm ESP encrypt: id=12, name=ESP_AES, ivlen=128, keysizemin=128, keysizemax=256
000 algorithm ESP auth attr: id=1, name=AUTH_ALGORITHM_HMAC_MD5, keysizemin=128, keysizemax=128
000 algorithm ESP auth attr: id=2, name=AUTH_ALGORITHM_HMAC_SHA1, keysizemin=160, keysizemax=160
000 algorithm ESP auth attr: id=9, name=AUTH_ALGORITHM_AES_CBC, keysizemin=128, keysizemax=128
000  
000 algorithm IKE encrypt: id=3, name=OAKLEY_BLOWFISH_CBC, blocksize=8, keydeflen=128
000 algorithm IKE encrypt: id=5, name=OAKLEY_3DES_CBC, blocksize=8, keydeflen=192
000 algorithm IKE encrypt: id=7, name=OAKLEY_AES_CBC, blocksize=16, keydeflen=128
000 algorithm IKE encrypt: id=65004, name=OAKLEY_SERPENT_CBC, blocksize=16, keydeflen=128
000 algorithm IKE encrypt: id=65005, name=OAKLEY_TWOFISH_CBC, blocksize=16, keydeflen=128
000 algorithm IKE encrypt: id=65289, name=OAKLEY_TWOFISH_CBC_SSH, blocksize=16, keydeflen=128
000 algorithm IKE hash: id=1, name=OAKLEY_MD5, hashsize=16
000 algorithm IKE hash: id=2, name=OAKLEY_SHA1, hashsize=20
000 algorithm IKE hash: id=4, name=OAKLEY_SHA2_256, hashsize=32
000 algorithm IKE hash: id=6, name=OAKLEY_SHA2_512, hashsize=64
000 algorithm IKE dh group: id=2, name=OAKLEY_GROUP_MODP1024, bits=1024
000 algorithm IKE dh group: id=5, name=OAKLEY_GROUP_MODP1536, bits=1536
000 algorithm IKE dh group: id=14, name=OAKLEY_GROUP_MODP2048, bits=2048
000 algorithm IKE dh group: id=15, name=OAKLEY_GROUP_MODP3072, bits=3072
000 algorithm IKE dh group: id=16, name=OAKLEY_GROUP_MODP4096, bits=4096
000 algorithm IKE dh group: id=17, name=OAKLEY_GROUP_MODP6144, bits=6144
000 algorithm IKE dh group: id=18, name=OAKLEY_GROUP_MODP8192, bits=8192
000  
000 stats db_ops: {curr_cnt, total_cnt, maxsz} :context={0,0,0} trans={0,0,0} attrs={0,0,0} 
000  
000 "dns--westnet-eastnet": 192.0.2.0/24===%dns<east.uml.freeswan.org.>[@east,]---192.1.2.45...192.1.2.23---%dns<west.uml.freeswan.org.>[@west,]===192.0.1.0/24; unrouted; eroute owner: #0
000 "dns--westnet-eastnet":     myip=unset; hisip=unset;
000 "dns--westnet-eastnet":   ike_life: 3600s; ipsec_life: 28800s; rekey_margin: 540s; rekey_fuzz: 100%; keyingtries: 3
000 "dns--westnet-eastnet":   policy: RSASIG+ENCRYPT+TUNNEL+PFS; prio: 24,24; interface: ; 
000 "dns--westnet-eastnet":   newest ISAKMP SA: #0; newest IPsec SA: #0; 
000  
000  
west:~#
 echo done
done
west:~#
 ipsec setup stop
IPSEC EVENT: KLIPS device ipsec0 shut down.
ipsec_setup: Stopping Openswan IPsec...
west:~#
 named
west:~#
 ipsec setup start
ipsec_setup: Starting Openswan IPsec VERSION
west:~#
 /testing/pluto/bin/wait-until-pluto-started
west:~#
 ipsec auto --replace  dns--westnet-eastnet
west:~#
 ipsec whack --status
000 interface ipsec0/eth1 192.1.2.45
000 %myid = (none)
000 debug none
000  
000 algorithm ESP encrypt: id=3, name=ESP_3DES, ivlen=64, keysizemin=192, keysizemax=192
000 algorithm ESP encrypt: id=12, name=ESP_AES, ivlen=128, keysizemin=128, keysizemax=256
000 algorithm ESP auth attr: id=1, name=AUTH_ALGORITHM_HMAC_MD5, keysizemin=128, keysizemax=128
000 algorithm ESP auth attr: id=2, name=AUTH_ALGORITHM_HMAC_SHA1, keysizemin=160, keysizemax=160
000 algorithm ESP auth attr: id=9, name=AUTH_ALGORITHM_AES_CBC, keysizemin=128, keysizemax=128
000  
000 algorithm IKE encrypt: id=3, name=OAKLEY_BLOWFISH_CBC, blocksize=8, keydeflen=128
000 algorithm IKE encrypt: id=5, name=OAKLEY_3DES_CBC, blocksize=8, keydeflen=192
000 algorithm IKE encrypt: id=7, name=OAKLEY_AES_CBC, blocksize=16, keydeflen=128
000 algorithm IKE encrypt: id=65004, name=OAKLEY_SERPENT_CBC, blocksize=16, keydeflen=128
000 algorithm IKE encrypt: id=65005, name=OAKLEY_TWOFISH_CBC, blocksize=16, keydeflen=128
000 algorithm IKE encrypt: id=65289, name=OAKLEY_TWOFISH_CBC_SSH, blocksize=16, keydeflen=128
000 algorithm IKE hash: id=1, name=OAKLEY_MD5, hashsize=16
000 algorithm IKE hash: id=2, name=OAKLEY_SHA1, hashsize=20
000 algorithm IKE hash: id=4, name=OAKLEY_SHA2_256, hashsize=32
000 algorithm IKE hash: id=6, name=OAKLEY_SHA2_512, hashsize=64
000 algorithm IKE dh group: id=2, name=OAKLEY_GROUP_MODP1024, bits=1024
000 algorithm IKE dh group: id=5, name=OAKLEY_GROUP_MODP1536, bits=1536
000 algorithm IKE dh group: id=14, name=OAKLEY_GROUP_MODP2048, bits=2048
000 algorithm IKE dh group: id=15, name=OAKLEY_GROUP_MODP3072, bits=3072
000 algorithm IKE dh group: id=16, name=OAKLEY_GROUP_MODP4096, bits=4096
000 algorithm IKE dh group: id=17, name=OAKLEY_GROUP_MODP6144, bits=6144
000 algorithm IKE dh group: id=18, name=OAKLEY_GROUP_MODP8192, bits=8192
000  
000 stats db_ops: {curr_cnt, total_cnt, maxsz} :context={0,0,0} trans={0,0,0} attrs={0,0,0} 
000  
000 "dns--westnet-eastnet": 192.0.1.0/24===192.1.2.45<west.uml.freeswan.org.>[@west]...192.1.2.23<east.uml.freeswan.org.>[@east]===192.0.2.0/24; unrouted; eroute owner: #0
000 "dns--westnet-eastnet":     myip=unset; hisip=unset;
000 "dns--westnet-eastnet":   ike_life: 3600s; ipsec_life: 28800s; rekey_margin: 540s; rekey_fuzz: 100%; keyingtries: 3
000 "dns--westnet-eastnet":   policy: RSASIG+ENCRYPT+TUNNEL+PFS; prio: 24,24; interface: eth1; 
000 "dns--westnet-eastnet":   newest ISAKMP SA: #0; newest IPsec SA: #0; 
000  
000  
west:~#
 ipsec auto --up dns--westnet-eastnet
104 "dns--westnet-eastnet" #1: STATE_MAIN_I1: initiate
003 "dns--westnet-eastnet" #1: received Vendor ID payload [Openswan 
003 "dns--westnet-eastnet" #1: received Vendor ID payload [Dead Peer Detection]
106 "dns--westnet-eastnet" #1: STATE_MAIN_I2: sent MI2, expecting MR2
108 "dns--westnet-eastnet" #1: STATE_MAIN_I3: sent MI3, expecting MR3
004 "dns--westnet-eastnet" #1: STATE_MAIN_I4: ISAKMP SA established {auth=OAKLEY_RSA_SIG cipher=aes_128 prf=oakley_sha group=modp1536}
117 "dns--westnet-eastnet" #2: STATE_QUICK_I1: initiate
004 "dns--westnet-eastnet" #2: STATE_QUICK_I2: sent QI2, IPsec SA established tunnel mode
west:~#
 echo done
done
west:~#
 

west:~#
west:~#
 if [ -f /tmp/core ]; then echo CORE FOUND; mv /tmp/core /var/tmp; fi
west:~#

