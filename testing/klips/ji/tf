#!/bin/sh
#
# RCSID $Id: tf,v 1.4 2002/04/24 07:36:17 mcr Exp $
#
# This script is OBSOLETE -- rgb, May 6th, 1998
# usage: ./addrt src srcmask dst dstmask edst spi
# usage: ./seti4 dst spi alg osrc odst
# usage: ./setah dst spi alg algdata
# usage: ./setesp dst spi alg iv key

# ALG=$1

tncfg attach ipsec0 eth0
ifconfig ipsec0 10.2.0.143 netmask 255.255.0.0
route add -net 10.3.0.0 netmask 255.255.0.0 dev ipsec0

# forward path

../utils/addrt 10.1.0.0 255.255.0.0 10.3.0.0 255.255.0.0 10.2.0.139 103
echo sleeping after addrt
sleep 1

../utils/setsa 10.2.0.139 103 ip4 10.2.0.143 10.2.0.139
../utils/setsa 10.2.0.139 105 esp des-md5 r 6630663066303132

../utils/spigrp 10.2.0.139 103 10.2.0.139 105

../utils/setsa 10.2.0.143 114 ah md5 66306630663031326630663066303132
../utils/setsa 10.2.0.143 115 esp 3des-md5 i 1000000000000001 6630663066303132
../utils/setsa 10.2.0.143 116 ah hmac-md5 66306630663031326630663066303132
../utils/setsa 10.2.0.143 117 ah hmac-sha1 66306630663031326630663066303132
../utils/setsa 10.2.0.143 118 esp des-md5 i 1000000000000001 6630663066303132
../utils/setsa 10.2.0.143 119 esp des-cbc 61626364 6630663066303132



# ../utils/seti4 10.2.0.139 103 1 10.2.0.143 10.2.0.139
# ../utils/setespdm 10.2.0.139 105 ${ALG} 6630663066303132
# ../utils/setesp 10.2.0.139 105 4 66306630 6630663066303132
# ../utils/setah 10.2.0.139 106 6 66306630663031326630663066303132

# ../utils/spigrp 10.2.0.139 103 10.2.0.139 105 10.2.0.139 106
# ../utils/spigrp 10.2.0.139 103 10.2.0.139 105

# return path

# ../utils/setespdm 10.2.0.143 115 ${ALG} 6630663066303132
# ../utils/setesp 10.2.0.143 115 4 66306630 6630663066303132
# ../utils/setah 10.2.0.143 116 6 66306630663031326630663066303132

#
# $Log: tf,v $
# Revision 1.4  2002/04/24 07:36:17  mcr
# Moved from ./klips/test/ji/tf,v
#
# Revision 1.3  1999/04/06 04:54:35  rgb
# Fix/Add RCSID Id: and Log: bits to make PHMDs happy.  This includes
# patch shell fixes.
#
#
