./h2hI2 ike_alg_register_enc(): Activating OAKLEY_AES_CBC: Ok (ret=0)
./h2hI2 ike_alg_register_hash(): Activating OAKLEY_SHA2_512: Ok (ret=0)
./h2hI2 ike_alg_register_prf(): Activating prf-hmac-sha2-512: Ok (ret=0)
./h2hI2 ike_alg_register_hash(): Activating OAKLEY_SHA2_256: Ok (ret=0)
./h2hI2 ike_alg_register_prf(): Activating prf-hmac-sha2-256: Ok (ret=0)
./h2hI2 ike_alg_register_hash(): Activating OAKLEY_SHA1: Ok (ret=0)
./h2hI2 ike_alg_register_prf(): Activating prf-hmac-sha1: Ok (ret=0)
./h2hI2 ike_alg_register_hash(): Activating OAKLEY_MD5: Ok (ret=0)
./h2hI2 ike_alg_register_prf(): Activating prf-hmac-md5: Ok (ret=0)
./h2hI2 adjusting ipsec.d to ../samples/davecert
./h2hI2 loading secrets from "../samples/parker.secrets"
./h2hI2 loaded private key for keyid: PPK_RSA:AQN7wUerV/66A6 7046 BBAB E28F 310E C6C0 80EC 790E F556 2AB9
./h2hI2   loaded CA cert file 'rootCA.pem' (CERT bytes)
./h2hI2 registed kernel encr algorithm aes_cbc [12, 128<=key<=512]
./h2hI2 registed kernel encr algorithm 3des [3, 192<=key<=192]
./h2hI2 registed kernel integ algorithm hmac_sha1_96 [2, 160<=key<=160]
./h2hI2 registed kernel integ algorithm hmac_md5_96 [1, 128<=key<=128]
./h2hI2 registed kernel integ algorithm hmac_sha2_256_128 [12, 256<=key<=256]
./h2hI2 registed kernel integ algorithm hmac_sha2_512_256 [14, 256<=key<=256]
| processing whack message of size: A
| processing whack message of size: A
processing whack msg time: X size: Y
| find_host_pair: looking for me=<none>:500 %any him=<none>:500 any-match
| find_host_pair: concluded with <none>
| found_host_pair_conn (check_connection_end): %any:500 %any/%any:500 -> hp:none
| Added new connection home with policy RSASIG+ENCRYPT+TUNNEL+PFS+!IKEv1+IKEv2ALLOW+IKEv2Init+SAREFTRACK
./h2hI2   loading certificate from daveCert.pem
./h2hI2   loaded host cert file '../samples/davecert/certs/daveCert.pem' (CERT bytes)
| certificate is valid
| counting wild cards for C=CA, ST=ON, O=Xelerance, CN=dave@openswan.org is 0
| counting wild cards for C=CA, ST=Canada, L=Ottawa, O=Xelerance Corporation, OU=Doctor Taylor Plumage, CN=moon.testing.openswan.org, E=mcr@ xelerance.com is 0
| orient home checking against if: eth0 (AF_INET:192.168.1.1:500)
| orient home checking against if: eth0 (AF_INET:192.168.1.1:4500)
| orient home checking against if: eth0 (AF_INET6:2606:2800:220:1:248:1893:25c8:1946:500)
| orient home matching on public/private keys: this=no[%address] that=no[%defaultroute]
|   orient home matched on that being defaultroute, and this lacking private key
| pick_if looking for port: 500, family: 2
|   considering eth0 192.168.1.1 port: 500, family: 2, best: <none>/0 0
|   considering eth0 192.168.1.1 port: 4500, family: 2, best: eth0/20 0
|   considering eth0 2606:2800:220:1:248:1893:25c8:1946 port: 500, family: 10, best: eth0/20 0
|   picking maching interface for family[2,2]: AF_INET resulted in: 192.168.1.1
|   orient home finished with: 1 [192.168.1.1]
| find_host_pair: looking for me=<invalid>:500 %address him=132.213.238.7:500 exact-match
| find_host_pair: concluded with <none>
| connect_to_host_pair: <invalid>:500 %address 132.213.238.7:500 -> hp:none
| find_ID_host_pair: looking for me=C=CA, ST=ON, O=Xelerance, CN=dave@openswan.org him=C=CA, ST=Canada, L=Ottawa, O=Xelerance Corporation, OU=Doctor Taylor Plumage, CN=moon.testing.openswan.org, E=mcr@ xelerance.com (exact)
|   concluded with <none>
./h2hI2 adding connection: "home"
| %any[C=CA, ST=ON, O=Xelerance, CN=dave@openswan.org]...132.213.238.7[C=CA, ST=Canada, L=Ottawa, O=Xelerance Corporation, OU=Doctor Taylor Plumage, CN=moon.testing.openswan.org, E=mcr@ xelerance.com]===10.2.0.0/16
| ike_life: 3600s; ipsec_life: 1200s; rekey_margin: 180s; rekey_fuzz: 100%; keyingtries: 1; policy: RSASIG+ENCRYPT+TUNNEL+PFS+!IKEv1+IKEv2ALLOW+IKEv2Init+SAREFTRACK
|   orient home finished with: 1 [192.168.1.1]
RC=0 "home": %any[C=CA, ST=ON, O=Xelerance, CN=dave@openswan.org]...132.213.238.7[C=CA, ST=Canada, L=Ottawa, O=Xelerance Corporation, OU=Doctor Taylor Plumage, CN=moon.testing.openswan.org, E=mcr@ xelerance.com]===10.2.0.0/16; unrouted; eroute owner: #0
RC=0 "home":     myip=unset; hisip=unset; mycert=daveCert.pem;
RC=0 "home":   keys: 1:75B9 7996 96CB FFE9 9CEA F984 D596 602E 42AE 6535 2:none...
RC=0 "home":   ike_life: 3600s; ipsec_life: 1200s; rekey_margin: 180s; rekey_fuzz: 100%; keyingtries: 1; firstmsgid: 0
RC=0 "home":   policy: RSASIG+ENCRYPT+TUNNEL+PFS+!IKEv1+IKEv2ALLOW+IKEv2Init+SAREFTRACK; prio: 16,0; interface: eth0; kind=CK_PERMANENT
| find_phase1_state: no SA found for conn 'home'
| creating state object #1 at Z
| orient home checking against if: eth0 (AF_INET:192.168.1.1:500)
| orient home checking against if: eth0 (AF_INET:192.168.1.1:4500)
| orient home checking against if: eth0 (AF_INET6:2606:2800:220:1:248:1893:25c8:1946:500)
| orient home matching on public/private keys: this=no[%defaultroute] that=no[%address]
|   orient home matched on this being defaultroute, and that lacking private key
| pick_if looking for port: 500, family: 2
|   considering eth0 192.168.1.1 port: 500, family: 2, best: <none>/0 0
|   considering eth0 192.168.1.1 port: 4500, family: 2, best: eth0/20 0
|   considering eth0 2606:2800:220:1:248:1893:25c8:1946 port: 500, family: 10, best: eth0/20 0
|   picking maching interface for family[2,2]: AF_INET resulted in: 192.168.1.1
|   orient home finished with: 1 [192.168.1.1]
| ICOOKIE:  80 01 02 03  04 05 06 07
| RCOOKIE:  00 00 00 00  00 00 00 00
| state hash entry 4
| inserting state object #1 bucket: 4
./h2hI2 initiating v2 parent SA
./h2hI2 STATE_PARENT_I1: initiate
| __alg_info_ike_add() ealg=12 aalg=12 prfalg_id=5 modp_id=14, cnt=1
| __alg_info_ike_add() ealg=18 aalg=12 prfalg_id=5 modp_id=14, cnt=2
| __alg_info_ike_add() ealg=12 aalg=2 prfalg_id=5 modp_id=14, cnt=3
| __alg_info_ike_add() ealg=18 aalg=2 prfalg_id=5 modp_id=14, cnt=4
| __alg_info_ike_add() ealg=12 aalg=12 prfalg_id=5 modp_id=5, cnt=5
| __alg_info_ike_add() ealg=18 aalg=12 prfalg_id=5 modp_id=5, cnt=6
| __alg_info_ike_add() ealg=12 aalg=2 prfalg_id=5 modp_id=5, cnt=7
| __alg_info_ike_add() ealg=18 aalg=2 prfalg_id=5 modp_id=5, cnt=8
| __alg_info_ike_add() ealg=12 aalg=12 prfalg_id=5 modp_id=15, cnt=9
| __alg_info_ike_add() ealg=18 aalg=12 prfalg_id=5 modp_id=15, cnt=10
| __alg_info_ike_add() ealg=12 aalg=2 prfalg_id=5 modp_id=15, cnt=11
| __alg_info_ike_add() ealg=18 aalg=2 prfalg_id=5 modp_id=15, cnt=12
| found algorithm: aes_cbc(12)-hmac_sha2_256_128(12)-prfsha2_256(5)-MODP2048(14)
| not including aes_gcm_8(18)-hmac_sha2_256_128(12)-prfsha2_256(5)-MODP2048(14 in policy, as algorithm missing(enc:0,integ:32,prf:1,group:1)
| found algorithm: aes_cbc(12)-hmac_sha1_96(2)-prfsha2_256(5)-MODP2048(14)
| not including aes_gcm_8(18)-hmac_sha1_96(2)-prfsha2_256(5)-MODP2048(14) in policy, as algorithm missing(enc:0,integ:20,prf:1,group:1)
| found algorithm: aes_cbc(12)-hmac_sha2_256_128(12)-prfsha2_256(5)-MODP1536(5)
| not including aes_gcm_8(18)-hmac_sha2_256_128(12)-prfsha2_256(5)-MODP1536(5) in policy, as algorithm missing(enc:0,integ:32,prf:1,group:1)
| found algorithm: aes_cbc(12)-hmac_sha1_96(2)-prfsha2_256(5)-MODP1536(5)
| not including aes_gcm_8(18)-hmac_sha1_96(2)-prfsha2_256(5)-MODP1536(5) in policy, as algorithm missing(enc:0,integ:20,prf:1,group:1)
| found algorithm: aes_cbc(12)-hmac_sha2_256_128(12)-prfsha2_256(5)-MODP3072(15)
| not including aes_gcm_8(18)-hmac_sha2_256_128(12)-prfsha2_256(5)-MODP3072(15 in policy, as algorithm missing(enc:0,integ:32,prf:1,group:1)
| found algorithm: aes_cbc(12)-hmac_sha1_96(2)-prfsha2_256(5)-MODP3072(15)
| not including aes_gcm_8(18)-hmac_sha1_96(2)-prfsha2_256(5)-MODP3072(15) in policy, as algorithm missing(enc:0,integ:20,prf:1,group:1)
sending 628 bytes for ikev2_parent_outI1_common through eth0:500 [192.168.1.1:500] to 132.213.238.7:500 (using #1)
|   80 01 02 03  04 05 06 07  00 00 00 00  00 00 00 00
|   21 20 22 08  00 00 00 00  00 00 02 74  22 00 00 f4
|   02 00 00 28  01 01 00 04  03 00 00 08  01 00 00 0c
|   03 00 00 08  02 00 00 05  03 00 00 08  03 00 00 0c
|   00 00 00 08  04 00 00 0e  02 00 00 28  02 01 00 04
|   03 00 00 08  01 00 00 0c  03 00 00 08  02 00 00 05
|   03 00 00 08  03 00 00 02  00 00 00 08  04 00 00 0e
|   02 00 00 28  03 01 00 04  03 00 00 08  01 00 00 0c
|   03 00 00 08  02 00 00 05  03 00 00 08  03 00 00 0c
|   00 00 00 08  04 00 00 05  02 00 00 28  04 01 00 04
|   03 00 00 08  01 00 00 0c  03 00 00 08  02 00 00 05
|   03 00 00 08  03 00 00 02  00 00 00 08  04 00 00 05
|   02 00 00 28  05 01 00 04  03 00 00 08  01 00 00 0c
|   03 00 00 08  02 00 00 05  03 00 00 08  03 00 00 0c
|   00 00 00 08  04 00 00 0f  00 00 00 28  06 01 00 04
|   03 00 00 08  01 00 00 0c  03 00 00 08  02 00 00 05
|   03 00 00 08  03 00 00 02  00 00 00 08  04 00 00 0f
|   28 00 01 08  00 0e 00 00  45 a7 3f fb  25 20 77 b3
|   45 0a e4 91  a6 af 49 64  99 d7 99 08  e8 86 1f d1
|   29 c7 68 64  ab 29 c3 fb  ad 47 9a d0  6b 35 08 ed
|   d0 9c 59 fb  e8 b8 1e d8  0b a6 83 90  ca 4a 73 f6
|   5c c1 9f ad  32 57 70 e3  65 27 9a 8f  69 2d 52 ec
|   e1 42 bc db  80 8b 10 6a  02 71 fe 15  29 1e fa 8a
|   e6 21 89 84  d0 dd 72 19  09 1c 26 01  c4 3e bb c1
|   b6 cd ca fc  d6 f7 aa 0d  86 62 21 e4  1e 86 8a 74
|   5b 06 d5 2c  19 27 55 ca  bb 5e 1d 20  e0 e3 24 79
|   9b d9 65 a7  50 57 48 b1  5a d0 71 a2  60 ef 14 75
|   69 dd 14 1a  09 88 6d c3  b2 7d f5 18  bd c1 33 1d
|   b0 7d b6 dc  2b 1e a1 98  06 bb aa c4  a4 69 b3 c4
|   f0 4e 08 f3  ee 73 85 41  4f 5a dd d3  55 e1 ec a2
|   e1 97 fb 2f  f2 b0 6f bc  fc 5f 6b c2  3a 32 e6 46
|   e1 df 42 70  03 1c 0e a9  1d cb e0 75  ca dd 45 ad
|   d7 17 f9 02  ef e0 f9 78  d1 1e 82 8f  c2 b7 aa 25
|   19 6f 2f 08  4d 2b df dc  29 00 00 14  80 01 02 03
|   04 05 06 07  08 09 0a 0b  0c 0d 0e 0f  29 00 00 1c
|   00 00 40 04  ea 59 1e 1b  30 a3 e0 94  4c dc 91 5b
|   b0 95 3c 48  70 73 62 f1  2b 00 00 1c  00 00 40 05
|   cd bc 1b 74  02 d7 5e 4c  da 5b cd 1c  a1 08 87 2b
|   f9 7d c4 c2  00 00 00 10  4f 45 70 6c  75 74 6f 75
|   6e 69 74 30
| #1 complete v2 state transition with STF_OK
./h2hI2 transition from state STATE_IKEv2_START to state STATE_PARENT_I1
| v2_state_transition: st is #1; pst is #0; transition_st is #0
./h2hI2 STATE_PARENT_I1: sent v2I1, expected v2R1 (msgid: 00000000/4294967295)
0: output to OUTPUT/h2hI2.pcap
0: input from h2hR1.pcap
|   =========== input from pcap file h2hR1.pcap ========
| *received 457 bytes from 132.213.238.7:500 on eth0 (port=500)
|   80 01 02 03  04 05 06 07  de bc 58 3a  8f 40 d0 cf
|   21 20 22 20  00 00 00 00  00 00 01 c9  22 00 00 30
|   00 00 00 2c  01 01 00 04  03 00 00 0c  01 00 00 0c
|   80 0e 00 80  03 00 00 08  03 00 00 02  03 00 00 08
|   02 00 00 02  00 00 00 08  04 00 00 0e  28 00 01 08
|   00 0e 00 00  25 9a 4e 99  8d ac d9 7b  7d ad 9b 2a
|   bd 38 04 00  f7 71 32 4c  b0 95 5e 5c  c1 0b e2 92
|   80 c3 9f b5  30 9b f3 89  51 96 5b 75  c6 5b 85 1a
|   8f f3 2d 6a  b1 b9 66 fe  c5 2e a9 f4  9e e2 34 c3
|   d9 dd 47 17  18 90 fd ce  66 bd 6c e4  43 8a 74 49
|   1c 72 97 9f  d7 74 86 b1  82 7e 9f 17  82 5e 06 ba
|   d2 fd 71 7e  73 10 4b 8b  52 14 00 26  48 d2 59 2e
|   1c 89 3c bb  e7 e0 12 4a  cb 9b b4 06  45 ca df 18
|   ca 11 f3 28  68 35 09 9f  16 e5 14 33  ff a8 5c 28
|   ab 17 4b 29  3b 56 32 c7  53 ad 99 61  9c 56 f8 50
|   25 21 34 ab  2d b8 f0 ec  f9 23 ae 8c  b5 24 4d e0
|   e6 3e 29 d4  2e da b1 9c  6c 3b 1f 0b  bf ae be 6d
|   0f 58 c3 7a  95 be 9b 9f  8a e7 07 38  a6 54 e9 32
|   80 63 8c 60  b3 ed 8b 59  27 d3 03 7d  46 04 05 4c
|   6d d1 26 3c  4e 09 ea 63  e0 7a 6a 7a  a6 3d ed ac
|   39 8c bf 1f  de 9c d9 09  d2 a1 63 e1  28 12 5a 18
|   31 fb 82 ee  29 00 00 14  00 84 b6 7e  d1 b6 d1 52
|   89 0e d7 1c  74 b9 26 e4  29 00 00 1c  00 00 40 04
|   1d 77 eb e3  db b6 db 7c  4b b5 ef 4b  57 c6 f1 b8
|   ec 7e 9b fe  26 00 00 1c  00 00 40 05  81 b5 74 15
|   c4 1e 64 b8  4c 1a 4e 9c  14 92 f7 ab  25 31 bf 62
|   2b 00 00 19  04 86 cb 59  12 06 07 df  3f 00 36 b9
|   64 c6 c5 14  1f 3a ed cd  aa 00 00 00  10 4f 45 70
|   6c 75 74 6f  75 6e 69 74  30
|  processing version=2.0 packet with exchange type=ISAKMP_v2_SA_INIT (34), msgid: 00000000
| I am the IKE SA Initiator
| I am this exchange's Initiator
| ICOOKIE:  80 01 02 03  04 05 06 07
| RCOOKIE:  de bc 58 3a  8f 40 d0 cf
| state hash entry 28
| v2 state object not found
| ICOOKIE:  80 01 02 03  04 05 06 07
| RCOOKIE:  de bc 58 3a  8f 40 d0 cf
| state hash entry 28
| v2 state object not found
| ICOOKIE:  80 01 02 03  04 05 06 07
| RCOOKIE:  00 00 00 00  00 00 00 00
| state hash entry 4
| v2 peer and cookies match on #1
| v2 state object #1 (home) found, in STATE_PARENT_I1
| removing state object #1
| ICOOKIE:  80 01 02 03  04 05 06 07
| RCOOKIE:  00 00 00 00  00 00 00 00
| state hash entry 4
| ICOOKIE:  80 01 02 03  04 05 06 07
| RCOOKIE:  de bc 58 3a  8f 40 d0 cf
| state hash entry 28
| inserting state object #1 bucket: 28
| state found and its state is:STATE_PARENT_I1 msgid: 00000
| considering state entry: 0
| now proceed with state specific processing using state #0 initiator-V2_init
| nat chunk  80 01 02 03  04 05 06 07  de bc 58 3a  8f 40 d0 cf
|   84 d5 ee 07  01 f4
| nat-t payloads for v2N_NAT_DETECTION_SOURCE_IP match: no NAT
| nat chunk  80 01 02 03  04 05 06 07  de bc 58 3a  8f 40 d0 cf
|   c0 a8 01 01  01 f4
| nat-t payloads for v2N_NAT_DETECTION_DESTINATION_IP match: no NAT
| ikev2 parent inR1: calculating g^{xy} in order to send I2
| has a v2CERTREQ payload going to decode it
| requested CA keyID  86 cb 59 12  06 07 df 3f  00 36 b9 64  c6 c5 14 1f
|   3a ed cd aa
| proposal 1   succ encr= (policy:             aes_cbc[128] vs offered:aes_cbc[-1]) [0,1]
| proposal 1 failed integ=(policy:   hmac_sha2_256_128 vs offered:hmac_sha1_96)
| proposal 1 failed prf=  (policy:   prf-hmac-sha2-256 vs offered:prf-hmac-sha1)
| proposal 1   succ dh=   (policy:OAKLEY_GROUP_MODP2048 vs offered:OAKLEY_GROUP_MODP2048)
| processor 'initiator-V2_init' returned STF_FAIL+14 (22)
| #1 complete v2 state transition with STF_FAIL+14
| pass 0: considering CHILD SAs to delete
./h2hI2 deleting state #1 (STATE_PARENT_I1)
| considering request to delete IKE parent state
| removing state object #1
| ICOOKIE:  80 01 02 03  04 05 06 07
| RCOOKIE:  de bc 58 3a  8f 40 d0 cf
| state hash entry 28
| pass 1: considering PARENT SAs to delete
./h2hI2 leak: ca keyid, item size: X
./h2hI2 leak: generalName, item size: X
./h2hI2 leak: nonce, item size: X
./h2hI2 leak: Gr, item size: X
./h2hI2 leak: saved first packet, item size: X
./h2hI2 leak: reply packet for ikev2_parent_outI1_tail, item size: X
./h2hI2 leak: sa in main_outI1, item size: X
./h2hI2 leak: initiator nonce, item size: X
./h2hI2 leak: long term secret, item size: X
./h2hI2 leak: saved gi value, item size: X
./h2hI2 leak: msg_digest, item size: X
./h2hI2 leak: ikev2_outI1 KE, item size: X
./h2hI2 leak: db_context->trans (expand), item size: X
./h2hI2 leak: db_context->conj (expand), item size: X
./h2hI2 leak: alg_info_ike, item size: X
./h2hI2 leak: db_context->attrs, item size: X
./h2hI2 leak: db_context->conj, item size: X
./h2hI2 leak: v2 policy database, item size: X
./h2hI2 leak: struct state in new_state(), item size: X
./h2hI2 leak: rfc3110 format of public key [created], item size: X
./h2hI2 leak: issuer dn, item size: X
./h2hI2 leak: keep id name, item size: X
./h2hI2 leak: pubkey entry, item size: X
./h2hI2 leak: issuer, item size: X
./h2hI2 leak: pubkey, item size: X
./h2hI2 leak: rfc3110 format of public key [created], item size: X
./h2hI2 leak: issuer dn, item size: X
./h2hI2 leak: keep id name, item size: X
./h2hI2 leak: pubkey entry, item size: X
./h2hI2 leak: pubkey, item size: X
./h2hI2 leak: certificate filename, item size: X
./h2hI2 leak: generalName, item size: X
./h2hI2 leak: x509cert, item size: X
./h2hI2 leak: CA cert, item size: X
./h2hI2 leak: 2 * id list, item size: X
./h2hI2 leak: rfc3110 format of public key [created], item size: X
./h2hI2 leak: pubkey, item size: X
./h2hI2 leak: secret, item size: X
./h2hI2 leak: policies path, item size: X
./h2hI2 leak: ocspcerts path, item size: X
./h2hI2 leak: aacerts path, item size: X
./h2hI2 leak: certs path, item size: X
./h2hI2 leak: private path, item size: X
./h2hI2 leak: crls path, item size: X
./h2hI2 leak: cacert path, item size: X
./h2hI2 leak: acert path, item size: X
./h2hI2 leak: override ipsec.d, item size: X
./h2hI2 leak: 4 * hasher name, item size: X
./h2hI2 leak: 10 * group description, item size: X
./h2hI2 leak: policies path, item size: X
./h2hI2 leak: ocspcerts path, item size: X
./h2hI2 leak: aacerts path, item size: X
./h2hI2 leak: certs path, item size: X
./h2hI2 leak: private path, item size: X
./h2hI2 leak: crls path, item size: X
./h2hI2 leak: cacert path, item size: X
./h2hI2 leak: acert path, item size: X
./h2hI2 leak: default conf var_dir, item size: X
./h2hI2 leak: default conf conffile, item size: X
./h2hI2 leak: default conf ipsecd_dir, item size: X
./h2hI2 leak: default conf ipsec_conf_dir, item size: X
./h2hI2 leak detective found Z leaks, total size X
